module univalence where
import experiments/equiv

def ua (A B : U) (e : equiv A B) : Path U A B :=
ua-weak A B e.1 e.2.2.1 (linv-inv A B e.1 e.2.1.1 e.2.2.1 e.2.1.2 e.2.2.2) e.2.2.2

def ideqv (A B : U) (p : Path U A B) : equiv A B :=
coe (apd (equiv A) p) (equiv-id A)

def idiso (A B : U) (p : Path U A B) : iso A B :=
coe (apd (iso A) p) (iso-id A)

def uaÎ² (A B : U) (e : equiv A B) (x : A) : Path B (coe (ua A B e) x) (e.1 x) :=
idp (e.1 x)

def equiv-symmâ€² (A B : U) (e : equiv A B) : equiv B A :=
ideqv B A (ua A B e)â»Â¹

def equiv-transâ€² (A B C : U) (eâ‚ : equiv A B) (eâ‚‚ : equiv B C) : equiv A C :=
ideqv A C (ua A B eâ‚ â¬ ua B C eâ‚‚)

def ua-ideqv (A B : U) (p : Path U A B) : Path (Path U A B) (ua A B (ideqv A B p)) p :=
coe (apd (Î» (w : Î£ (X : U), Path U A X), Path (Path U A w.1) (ua A w.1 (ideqv A w.1 w.2)) w.2)
  (Î£-prod p (Î» (X : U), Path U A X) (idp A) p (idp p))) (idp (idp A))

def ideqv-uaâ‚ (A B : U) (e : equiv A B) : Path (A â†’ B) (ideqv A B (ua A B e)).1 e.1 := idp e.1
def ideqv-uaâ‚‚ (A B : U) (e : equiv A B) : Path (B â†’ A) (ideqv A B (ua A B e)).2.2.1 e.2.2.1 := idp e.2.2.1

def ua-weak-symm (A B : U) (e : iso A B) : iso B A :=
idiso B A (ua-weak A B e.1 e.2.1 e.2.2.1 e.2.2.2)â»Â¹

def ua-weak-trans (A B C : U) (eâ‚ : iso A B) (eâ‚‚ : iso B C) : iso A C :=
idiso A C (ua-weak A B eâ‚.1 eâ‚.2.1 eâ‚.2.2.1 eâ‚.2.2.2 â¬
           ua-weak B C eâ‚‚.1 eâ‚‚.2.1 eâ‚‚.2.2.1 eâ‚‚.2.2.2)

def negate : ğŸ â†’ ğŸ :=
indâ‚‚ (Î» (_ : ğŸ), ğŸ) 1â‚‚ 0â‚‚

def negate-negate :=
indâ‚‚ (Î» (x : ğŸ), Path ğŸ (negate (negate x)) x) (idp 0â‚‚) (idp 1â‚‚)

def bool-neg-path : Path U ğŸ ğŸ :=
ua-weak ğŸ ğŸ negate negate negate-negate negate-negate

def 0â‚‚-eq-0â‚‚-bad-way : Path ğŸ 0â‚‚ 0â‚‚ :=
(ideqv ğŸ ğŸ bool-neg-path).2.2.2 0â‚‚
